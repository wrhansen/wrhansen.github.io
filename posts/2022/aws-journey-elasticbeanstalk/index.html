<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><script defer language=javascript type=text/javascript src=/js/bundle.min.5991d603939a6d188be342b278a4555db90f163903158c623d2c39fde3d82cb3.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.png><title itemprop=name>wrhansen.dev - TIL: AWS Elastic Beanstalk</title>
<meta property="og:title" content="wrhansen.dev - TIL: AWS Elastic Beanstalk"><meta name=twitter:title content="wrhansen.dev - TIL: AWS Elastic Beanstalk"><meta itemprop=name content="wrhansen.dev - TIL: AWS Elastic Beanstalk"><meta name=application-name content="wrhansen.dev - TIL: AWS Elastic Beanstalk"><meta property="og:site_name" content="wrhansen.dev"><meta name=description content="My Experience Learning How To Use Elastic Beanstalk"><meta itemprop=description content="My Experience Learning How To Use Elastic Beanstalk"><meta property="og:description" content="My Experience Learning How To Use Elastic Beanstalk"><meta name=twitter:description content="My Experience Learning How To Use Elastic Beanstalk"><base href=https://blog.wrhansen.dev/posts/2022/aws-journey-elasticbeanstalk/><link rel=canonical href=https://blog.wrhansen.dev/posts/2022/aws-journey-elasticbeanstalk/ itemprop=url><meta name=url content="https://blog.wrhansen.dev/posts/2022/aws-journey-elasticbeanstalk/"><meta name=twitter:url content="https://blog.wrhansen.dev/posts/2022/aws-journey-elasticbeanstalk/"><meta property="og:url" content="https://blog.wrhansen.dev/posts/2022/aws-journey-elasticbeanstalk/"><meta property="og:updated_time" content="2023-02-20T20:12:53-05:00"><link rel=sitemap type=application/xml title=Sitemap href=https://blog.wrhansen.dev/sitemap.xml><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta property="fb:admins" content><meta name=apple-mobile-web-app-title content="wrhansen.dev"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=generator content="Hugo 0.147.2"><link type=text/css rel=stylesheet href=/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css><style>body{--sidebar-bg-color:#002b36;--sidebar-img-border-color:#657b83;--sidebar-p-color:#586e75;--sidebar-h1-color:#93a1a1;--sidebar-a-color:#839496;--sidebar-socials-color:#586e75;--text-color:#657b83;--bkg-color:#eee8d5;--post-title-color:#93a1a1;--list-color:#eee8d5;--link-color:#268bd2;--date-color:#b58900;--table-border-color:#657b83;--table-stripe-color:#b58900;--code-color:#000;--code-background-color:#E5E5E5;--code-block-color:#fff;--code-block-background-color:#272822;--moon-sun-color:#eee8d5;--moon-sun-background-color:#073642}body.dark-theme{--text-color:#839496;--bkg-color:#073642;--post-title-color:#93a1a1;--list-color:#eee8d5;--link-color:#268bd2;--date-color:#b58900;--table-border-color:#657b83;--table-stripe-color:#b58900;--code-color:#fff;--code-background-color:#515151;--code-block-color:#fff;--code-block-background-color:#272822}body{background-color:var(--bkg-color)}</style></head><body class=dark-theme><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://blog.wrhansen.dev/><h1>wrhansen.dev</h1></a></h1><p class=lead>Rantings and Ravings of a Software Professional</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/posts/>Posts</a></li><li class=sub-heading>Most Recent:</li><li class=bullet><a href=https://blog.wrhansen.dev/posts/2023/automating-my-second-brain/>Using Github Actions to Automate My Second Brain</a></li><li class=bullet><a href=https://blog.wrhansen.dev/posts/2022/aws-journey-elasticbeanstalk/>TIL: AWS Elastic Beanstalk</a></li><li class=bullet><a href=https://blog.wrhansen.dev/posts/2022/email-for-professionals/>Email for Professionals</a></li><li class=bullet><a href=https://blog.wrhansen.dev/posts/2022/docs-for-developers/>Docs for Developers</a></li><li class=bullet><a href=https://blog.wrhansen.dev/posts/2022/how-is-this-blog-made/>How is This Blog Made?</a></li><li class=heading><a href=/tags/>Tags</a></li><li class=heading><a href=/series/>Series</a></li><li class=heading><a href=/about/>About</a></li></ul></nav><a target=_blank class=social title=GitHub href=https://github.com/wrhansen><svg width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg>
</a><a target=_blank class=social title=LinkedIn href=https://www.linkedin.com/in/wes-hansen/><svg width="1em" height="1.2em" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a><a target=_blank class=social title="RSS Feed" href=/posts/index.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>powered by <a target=_blank href=https://gohugo.io>Hugo</a> | themed with <a target=_blank href=https://github.com/lukeorth/poison>poison</a><br>&copy; 2025 wrhansen.dev. All rights reserved.</p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://blog.wrhansen.dev/posts/2022/aws-journey-elasticbeanstalk/>TIL: AWS Elastic Beanstalk</a></h1><div class=headline><div><span>Wesley Hansen - </span><time datetime=2022-12-28T20:15:00-0400 class=post-date>December 28, 2022
</time><span>- </span><span class=reading-time><span>10 mins read</span></span></div><ul class=tags><li class=tag-aws><a href=https://blog.wrhansen.dev/tags/aws>aws</a></li><li class=tag-til><a href=https://blog.wrhansen.dev/tags/til>til</a></li><li class=tag-eb><a href=https://blog.wrhansen.dev/tags/eb>eb</a></li><li class=tag-heroku><a href=https://blog.wrhansen.dev/tags/heroku>heroku</a></li></ul></div></div><h2 id=background>Background</h2><p>My immediate family (8 of us total) has a private chat group using the <em>GroupMe</em> app <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
that we have been using for a couple of years now. When we first started using <em>GroupMe</em>
for our chat, I was happy because it offered an <a href=https://dev.groupme.com/ target=_blank>API</a>
that you use to enhance the group chat. So I played around with it one weekend
and the <a href=https://github.com/wrhansen/hansenbot target=_blank>hansenbot</a> was created.</p><p>The <code>hansenbot</code> is a pretty simple django app that exposes a hook URL that you
can setup that <em>GroupMe</em> will forward all messages in your group to. I created the
<code>hansenbot</code> to respond to certain commands that are typed in the group chat that
have the following form: <code>!hb &lt;command></code> where <code>!hb</code> tells the bot that the given
message is a command that it needs to respond to and <code>&lt;command></code> is one of the
preconfigured commands that I created that report information back to the
<em>GroupMe</em> group. These commands I created range from telling &ldquo;dad jokes&rdquo;, giving
current weather information for all the locations where my family lives and
information about the next upcoming birthday.</p><p>Eventually I also added a &ldquo;daily digest&rdquo; feature, implemented as a django management
command, that can be run every morning to give an update on all the things the
family cares about. In our case that&rsquo;s upcoming birthdays, reminders for important
dates and weather forecasts.</p><h2 id=heroku-is-easy-to-setup>Heroku is Easy to Setup</h2><p>It was relatively easy to whip up a simple django app but in order to configure
the <em>GroupMe</em> callback, I needed to deploy this somehwere publicly. Personally
I don&rsquo;t like spending a lot of time on the logistics of deploying stuff so I opted
to use <em>Heroku</em> for such a thing. With Heroku, I essentially just had to install
a couple lines of code in the django settings, set up a <code>Procfile</code>, connect your
github account and repository and away it goes.</p><p>My initial setup was great, and worked really well with <em>Heroku</em> because everything
was free, including the &ldquo;dyno&rdquo;, postgres database, and redis instance. Everything
a dev needs to create a high functioning site. <em>Heroku</em> had a pretty decent &ldquo;free&rdquo;
tier to get developers hooked on using their platform and
seeing the benefits first-hand. It wasn&rsquo;t until I wanted to introduce a &ldquo;cron&rdquo;
job that my <em>Heroku</em> setup required some form of payment. The introduction of a
&ldquo;cron&rdquo; job (in my case, I created a celery beat process) required an additional
dyno, heroku&rsquo;s concept of a container, which seems to be limited to a single
process. So, bumping up the dynos from one to two moved me a $14/month payment
plan. I have to admit, it was quite high in my opinion but overall I decided it
was still worth it because I really do not like messing around with deployments
and this was still super convenient.</p><h2 id=the-problem-heroku-made-some-big-changes>The Problem: Heroku Made Some Big Changes</h2><p>This past year, <em>Heroku</em> decided to make a pretty significant change to the
pricing on their platform. You can read more about these changes <a href=https://blog.heroku.com/next-chapter target=_blank>here</a>.
Essentially these changes were going to do away with the &ldquo;Hobby&rdquo; tier by no
longer offering free versions of database and redis. Once the change came out my
database and redis instance were gone and my simple little bot no longer worked.
I looked into it and it just wasn&rsquo;t worth it anymore to have my tiny little bot
site deployed on Heroku anymore (it would have doubled my monthly payments to
keep it going)!</p><p>So I set out to find a replacement platform where I could deploy my bot site to
at a reasonable price.</p><h2 id=the-switch-to-aws>The Switch to AWS</h2><p>I ultimately decided that I wanted to learn more about AWS, as I am knowledgable
of some services that AWS offers, but wanted to get more of an understanding of
it in general since we use it a lot at work and our use cases are currently growing.
I know AWS is a vast collection of cloud-based tools and services and didn&rsquo;t really
know what the best option for my bot site is. So I asked some of my colleagues
for suggestions on how I should go about deploying this site on AWS. One colleague
suggested I use Elastic Beanstalk and others suggested Lambda. I knew about
serverless lambda as a concept, but I really wanted to try something that was
closer in scope to Heroku&rsquo;s platform to minimize the changes I&rsquo;d need to make to
my bot site.</p><p>So, I decided to create my own private AWS account, and sign up for a year
of &ldquo;Free Tier&rdquo;, which you can do <a href=https://aws.amazon.com/free/ target=_blank>here</a>.
My experience with setting up the account was fine, it&rsquo;s fairly simple to enter
in all the standard information, and credit card, etc. When I finally get through
the account creation process and landed on the management console homepage&mldr;I was
a bit overwhelmed. You get a sense that you&rsquo;re into something much bigger than
yourself. There&rsquo;s seriously millions of things you can do with this account and
it isn&rsquo;t necessarily immediately clear. To be fair to Amazon, they know this
about AWS (and cloud in general) and provide plenty of links to &ldquo;getting started&rdquo;
articles, documentation and tutorials to get you going on your journey into AWS.</p><img src=/resources/aws-help-widget.png alt="AWS Console Widget" class=center style=border-radius:8px><h2 id=elastic-beanstalk-is-confusingat-first>Elastic Beanstalk Is Confusing&mldr;At First</h2><p>So I started my AWS journey by watching a few videos and reading through some
of the basic overview articles that the above help widget provided. It walked
me through some basic definitions of concepts and services that AWS offers.</p><p>I also got acquainted with installing <a href=https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html target=_blank>AWS CLI</a>
and configuring <a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html target=_blank>IAM</a>
to give me a separate user admin user account from the root and also setup
additional security like MFA login for the account.</p><p>Finally the tutorials lead me to try deploying a simple web app on
<a href=https://aws.amazon.com/getting-started/guides/deploy-webapp-elb/ target=_blank>AWS Elastic Beanstalk</a>.
This tutorial was fairly small and simple to walk through although I must say it
did nothing to help me really understand what Elastic Beanstalk (EB) does. The
tutoral has you write out a bunch of custom javascript that actually create
infrastructure like EC2 instances and S3 buckets. I kinda got the idea, but hoped
that maybe there was a better, more simpler way without having to write all this
custom code (especially in javascript).</p><p>I told myself to stick to the tutorial even though I was a little worried about
the direction it was going, and felt like I wasn&rsquo;t exactly learning about what
EB actually was.</p><h2 id=finding-a-more-suitable-tutorial>Finding A More Suitable Tutorial</h2><p>Eventaully I finished that tutorial, and ended up with the product as desired,
and only had to suffer through a few snags in the tutorial where the tutorial
instructions were not entirely up to date with the latest libraries you installed.
A few minutes of searching around the internet was able to clear up any of these
issues so it was fairly straight forward.</p><p>After finishing this particularly confusing (to me) tutorial, I decided to dig
a little deeper and see if there was a tutorial that more directly suited my
needs now that the particular track I was following through the AWS help widget
had ended. So I did a quick search for &ldquo;django aws eb tutorial&rdquo; and the very first
result was another tutorial on the AWS documentation <a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-django.html target=_blank>here</a>.
I was surprised because the title was verbatim what I was looking for:
<em>&ldquo;Deploying a Django application to Elastic Beanstalk&rdquo;</em>. Perfect!</p><h2 id=the-right-tutorial>The Right Tutorial</h2><p>I was able to skip through the first three sections of the tutorial because they
simply involved setting up a python virtualenv, installing django and getting
a basic django project created. Instead, I was just going to tweak my existing
<code>hansenbot</code> site to work with this thing. I urge you to follow through the tutorial
linked in the previous section, as I won&rsquo;t detail it here. Instead I just want to
highlight the things that I learned and had to do to get my old heroku site ported
over to EB. So here&rsquo;s a fairly quick rundown of what I had to change:</p><ul><li>Create a <code>.ebextensions</code> folder in the root of the project.</li><li>Install <code>awsebcli</code> tool. (Note: I chose to do this through <a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-install-osx.html target=_blank>homebrew</a>)</li><li>Removed any references to django-heroku library (no longer using it in the project)</li><li>Change database to go off environment variables for RDS connection</li><li>From the aws EB management console, configure a RDS database for the application.
<a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-rds.html#python-rds-create target=_blank>link</a></li><li>Removed any reference to redis (for now) and configured celery tasks to run &ldquo;ALWAYS_EAGER&rdquo;</li><li>Configure an <em>ebextension</em> config file to run django <code>migrate</code> and <code>collectstatic</code>
on container deployment: <a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-django.html#python-django-migrate-site target=_blank>link</a></li><li>Configure an <em>ebextension</em> cron job to run the bot&rsquo;s &ldquo;daily digest&rdquo; command:
<a href=https://aws.amazon.com/premiumsupport/knowledge-center/cron-job-elastic-beanstalk/ target=_blank>link</a></li></ul><h2 id=things-i-learned>Things I Learned</h2><ul><li>EB works off of commits to your git repository, <a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb3-cli-git.html target=_blank>by default</a></li><li>EB can use ProcFiles like Heroku: <a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/python-configuration-procfile.html target=_blank>link</a></li><li>You can use <code>eb shell</code> to gain shell access to the EC2 instance that is running
your site. <a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb3-ssh.html target=_blank>link</a></li></ul><h2 id=use-github-actions-for-automation>Use Github Actions for Automation</h2><p>Now that I got everything working minimally, I wanted again to move the deployment
from my local shell (using the <code>awsebcli</code> commands) to some form of automation so
that I can &ldquo;set it and forget it&rdquo;. This was actually relatively easy by configuring
Github Actions on the repository. With a quick google search, I was able to find
someone already had a custom action for building and deploying EB environments.</p><p>This was easy to do, by following the readme for the github action defined
<a href=https://github.com/einaregilsson/beanstalk-deploy target=_blank>here</a>. In the end my github
action (<a href=https://github.com/wrhansen/hansenbot/blob/master/.github/workflows/deploy-eb.yaml target=_blank>here</a>)
looks like this:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#268bd2>name</span>: deploy-aws-eb
</span></span><span style=display:flex><span><span style=color:#268bd2>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>branches</span>:
</span></span><span style=display:flex><span>      - master
</span></span><span style=display:flex><span><span style=color:#268bd2>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#268bd2>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#268bd2>runs-on</span>: ubuntu-latest
</span></span><span style=display:flex><span>    <span style=color:#268bd2>environment</span>: hansenbot
</span></span><span style=display:flex><span>    <span style=color:#268bd2>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#268bd2>name</span>: Checkout Source
</span></span><span style=display:flex><span>        <span style=color:#268bd2>uses</span>: actions/checkout@v2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#268bd2>name</span>: Generate deployment package
</span></span><span style=display:flex><span>        <span style=color:#268bd2>run</span>: zip -r app.zip . -x &#39;*.git*&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#268bd2>name</span>: Deploy to EB
</span></span><span style=display:flex><span>        <span style=color:#268bd2>uses</span>: einaregilsson/beanstalk-deploy@v21
</span></span><span style=display:flex><span>        <span style=color:#268bd2>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#268bd2>aws_access_key</span>: ${{ secrets.AWS_ACCESS_KEY_ID }}
</span></span><span style=display:flex><span>          <span style=color:#268bd2>aws_secret_key</span>: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
</span></span><span style=display:flex><span>          <span style=color:#268bd2>application_name</span>: ${{ secrets.APPLICATION_NAME }}
</span></span><span style=display:flex><span>          <span style=color:#268bd2>environment_name</span>: ${{ secrets.ENVIRONMENT_NAME }}
</span></span><span style=display:flex><span>          <span style=color:#268bd2>existing_bucket_name</span>: ${{ secrets.AWS_BUCKET_NAME }}
</span></span><span style=display:flex><span>          <span style=color:#268bd2>version_label</span>: app-${{ github.SHA }}
</span></span><span style=display:flex><span>          <span style=color:#268bd2>region</span>: ${{ secrets.AWS_REGION }}
</span></span><span style=display:flex><span>          <span style=color:#268bd2>deployment_package</span>: app.zip
</span></span><span style=display:flex><span>          <span style=color:#268bd2>wait_for_deployment</span>: <span style=color:#cb4b16>true</span>
</span></span><span style=display:flex><span>          <span style=color:#268bd2>version_description</span>: ${{ github.SHA }}
</span></span></code></pre></div><p>There isn&rsquo;t really too much to say here, other than this workflow has 3 steps:</p><ul><li>checkout the latest commit from the master branch</li><li>generate a zip for the latest application &ldquo;build&rdquo;</li><li>deploy the app on EB with all the environment-specific stuff defined in secrets</li></ul><p>With this workflow file installed on my repository, I can now simply merge new
changes to the master branch and that kicks off a job that deploys the new changes
to EB. Excellent!</p><h2 id=improvements-id-like-to-make-eventually>Improvements I&rsquo;d like to make, eventually.</h2><p>As of the writing of this blog post, it is a fully functioning bot with all the
same features as the heroku version, however the deployment is quite perfect and
so I have a few things that I&rsquo;d like to work out. Perhaps these could be separate
blog posts when I actually get around to it.</p><p><strong>Configure Celery to work with AWS SQS</strong>. I&rsquo;d like to do this eventually, as
having dedicated background processes to performing bot commands frees up the
web requests and makes the bot chat feel much more responsive. For now, having
everything executed without Celery (or at least ALWAYS_EAGER) is a &ldquo;good enough&rdquo;
solution.</p><p><strong>Configure a &ldquo;dev&rdquo; EB environment that works off a dev branch</strong>. I&rsquo;d like to get
to the point where I have a dev branch that I can work off of that deploys to a
separate &ldquo;dev&rdquo; environment of the EB site. This way I can test new features under
development without effecting the production version. This is less of an issue
since the bot is so small in features and is only used by a handful of family
members, but still they can sometimes be annoyed if I flood our chat channel with
lots of spam messages that I might generate while testing new features.</p><h2 id=some-useful-references>Some Useful References</h2><p><a href=https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/platforms-linux-extend.html target=_blank>EB workflow</a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>I hate <em>GroupMe</em>, but that&rsquo;s another story&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><hr><div class=footer><a class=previous-post href="https://blog.wrhansen.dev/posts/2022/email-for-professionals/?ref=footer"><span style=font-weight:700>« Previous</span><br>Email for Professionals</a><div class=next-post><a href="https://blog.wrhansen.dev/posts/2023/automating-my-second-brain/?ref=footer"><span style=font-weight:700>Next »</span><br>Using Github Actions to Automate My Second Brain</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#heroku-is-easy-to-setup>Heroku is Easy to Setup</a></li><li><a href=#the-problem-heroku-made-some-big-changes>The Problem: Heroku Made Some Big Changes</a></li><li><a href=#the-switch-to-aws>The Switch to AWS</a></li><li><a href=#elastic-beanstalk-is-confusingat-first>Elastic Beanstalk Is Confusing&mldr;At First</a></li><li><a href=#finding-a-more-suitable-tutorial>Finding A More Suitable Tutorial</a></li><li><a href=#the-right-tutorial>The Right Tutorial</a></li><li><a href=#things-i-learned>Things I Learned</a></li><li><a href=#use-github-actions-for-automation>Use Github Actions for Automation</a></li><li><a href=#improvements-id-like-to-make-eventually>Improvements I&rsquo;d like to make, eventually.</a></li><li><a href=#some-useful-references>Some Useful References</a></li></ul></nav></div></div></div></body></html>